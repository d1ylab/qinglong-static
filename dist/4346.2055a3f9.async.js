(self.webpackChunk=self.webpackChunk||[]).push([[4346],{34346:function($,S,a){"use strict";a.r(S);var q=a(25359),A=a.n(q),ee=a(57213),P=a.n(ee),H=a(49811),ue=a.n(H),ae=a(54306),s=a.n(ae),E=a(63313),le=a.n(E),U=a(28756),n=a(67393),ne=a(9835),c=a(22159),te=a(55484),re=a(84163),D=a(84468),N=a(16861),oe=a(35911),l=a(90717),j=a(11186),_=a.n(j),h=a(46207),C=a.n(h),e=a(11527),f=U.Z.Option,Z=/([^\/\:]+\/[^\/]+)(?=\.git)/,y=/([^\/\:]+\/[^\/\.]+)\.[a-z]+$/,k=function(b){var o=b.subscription,O=b.handleCancel,x=b.visible,z=n.Z.useForm(),g=s()(z,1),i=g[0],B=(0,E.useState)(!1),J=s()(B,2),w=J[0],G=J[1],se=(0,E.useState)("public-repo"),Q=s()(se,2),v=Q[0],T=Q[1],R=(0,E.useState)("crontab"),he=s()(R,2),ie=he[0],ve=he[1],pe=(0,E.useState)("ssh-key"),_e=s()(pe,2),Fe=_e[0],Ce=_e[1],De=function(){var d=ue()(A()().mark(function u(t){var r,p,F,I,M;return A()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return G(!0),r=o?"put":"post",p=P()(P()({},t),{},{autoAddCron:!!t.autoAddCron,autoDelCron:!!t.autoDelCron}),o&&(p.id=o.id),m.prev=4,m.next=7,oe.W[r]("".concat(l.Z.apiPrefix,"subscriptions"),{data:p});case 7:F=m.sent,I=F.code,M=F.data,I===200&&(ne.ZP.success(o?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),O(M)),G(!1),m.next=17;break;case 14:m.prev=14,m.t0=m.catch(4),G(!1);case 17:case"end":return m.stop()}},u,null,[[4,14]])}));return function(t){return d.apply(this,arguments)}}(),fe=function(u){T(u.target.value);var t=i.getFieldValue("url"),r=i.getFieldValue("branch");i.setFieldsValue({alias:X(t,r,u.target.value)}),t&&i.validateFields(["url"])},xe=function(u){ve(u.target.value),i.setFieldsValue({schedule:""})},ge=function(u){Ce(u.target.value)},me=function(u){var t=i.getFieldValue("branch");i.setFieldsValue({alias:X(u.target.value,t)})},Ee=function(u){var t=i.getFieldValue("url");i.setFieldsValue({alias:X(t,u.target.value)})},X=function(u,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v,p="",F=r==="file"?y:Z;return F.test(u)&&(p=u.match(F)[1].replaceAll("/","_").replaceAll(".","_")),t&&(p=p+"_"+t),p},Be=function(u){var t=u.value,r=u.onChange,p=(0,E.useState)("days"),F=s()(p,2),I=F[0],M=F[1],Y=(0,E.useState)(),m=s()(Y,2),K=m[0],L=m[1],ce=function(W){M(W),K&&K>0&&(r==null||r({type:W,value:K}))},ye=function(W){L(W||1),W?r==null||r({type:I,value:W}):r==null||r(null)};return(0,E.useEffect)(function(){t&&(M(t.type),L(t.value))},[t]),(0,e.jsxs)(c.Z.Group,{compact:!0,children:[(0,e.jsx)(te.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:K,style:{width:"calc(100% - 58px)"},onChange:ye}),(0,e.jsxs)(U.Z,{value:I,onChange:ce,children:[(0,e.jsx)(f,{value:"days",children:"\u5929"}),(0,e.jsx)(f,{value:"hours",children:"\u65F6"}),(0,e.jsx)(f,{value:"minutes",children:"\u5206"}),(0,e.jsx)(f,{value:"seconds",children:"\u79D2"})]})]})},Ae=function(u){var t=u.value,r=u.onChange,p=u.type;return p==="ssh-key"?(0,e.jsx)(n.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,e.jsx)(n.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},de=(0,E.useCallback)(function(d){var u=d.clipboardData.getData("text");if(u.startsWith("ql ")){var t=u.split(" ").map(function(ce){return ce.trim().replace(/\"/g,"").replace(/\'/,"")}),r=s()(t,8),p=r[1],F=r[2],I=r[3],M=r[4],Y=r[5],m=r[6],K=r[7],L=p==="raw"?"file":F.startsWith("http")?"public-repo":"private-repo";i.setFieldsValue({type:L,url:F,whitelist:I,blacklist:M,dependences:Y,branch:m,extensions:K,alias:X(F,m,L)}),T(L)}},[]),Pe=(0,E.useCallback)(function(d){var u=d.clipboardData.getData("text");u.startsWith("ql ")&&d.preventDefault(),de(d)},[]),je=function(u){return P()(P()({},u),{},{autoAddCron:C()(u==null?void 0:u.autoAddCron)?!0:!!(u!=null&&u.autoAddCron),autoDelCron:C()(u==null?void 0:u.autoDelCron)?!0:!!(u!=null&&u.autoDelCron)})};return(0,E.useEffect)(function(){x?window.addEventListener("paste",de):window.removeEventListener("paste",de)},[x]),(0,E.useEffect)(function(){i.setFieldsValue(P()(P()({},o),je(o))||{}),T(o&&o.type||"public-repo"),ve(o&&o.schedule_type||"crontab"),Ce(o&&o.pull_type||"ssh-key"),o||i.resetFields()},[o,x]),(0,e.jsx)(re.Z,{title:o?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:x,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){i.validateFields().then(function(u){De(u)}).catch(function(u){console.log("Validate Failed:",u)})},onCancel:function(){return O()},confirmLoading:w,children:(0,e.jsxs)(n.Z,{form:i,name:"form_in_modal",layout:"vertical",children:[(0,e.jsx)(n.Z.Item,{name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u652F\u6301\u62F7\u8D1D ql repo/raw \u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:Pe})}),(0,e.jsx)(n.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,e.jsxs)(D.ZP.Group,{onChange:fe,children:[(0,e.jsx)(D.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,e.jsx)(D.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,e.jsx)(D.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,e.jsx)(n.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:v==="file"?y:Z}],children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:me,onChange:me})}),v!=="file"&&(0,e.jsx)(n.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:Ee,onChange:Ee})}),(0,e.jsx)(n.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,e.jsx)(c.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),v==="private-repo"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,e.jsxs)(D.ZP.Group,{onChange:ge,children:[(0,e.jsx)(D.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,e.jsx)(D.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,e.jsx)(Ae,{type:Fe})]}),(0,e.jsx)(n.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,e.jsxs)(D.ZP.Group,{onChange:xe,children:[(0,e.jsx)(D.ZP,{value:"crontab",children:"crontab"}),(0,e.jsx)(D.ZP,{value:"interval",children:"interval"})]})}),(0,e.jsx)(n.Z.Item,{name:ie==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(u,t){return ie==="interval"||!t||_().parseExpression(t).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:ie==="interval"?(0,e.jsx)(Be,{}):(0,e.jsx)(c.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),v!=="file"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(n.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(n.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(n.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,e.jsx)(n.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,e.jsx)(n.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]}),(0,e.jsx)(n.Z.Item,{name:"proxy",label:"\u4EE3\u7406",tooltip:"\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406",children:(0,e.jsx)(c.Z,{placeholder:v==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})}),(0,e.jsxs)(n.Z.Item,{style:{marginBottom:0},className:"inline-form-item",children:[(0,e.jsx)(n.Z.Item,{name:"autoAddCron",label:"\u81EA\u52A8\u6DFB\u52A0\u4EFB\u52A1",valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(N.Z,{})}),(0,e.jsx)(n.Z.Item,{name:"autoDelCron",label:"\u81EA\u52A8\u5220\u9664\u4EFB\u52A1",valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(N.Z,{})})]})]})})};S.default=k},16861:function($,S,a){"use strict";a.d(S,{Z:function(){return oe}});var q=a(60795),A=a(87807),ee=a(24090),P=a(84875),H=a.n(P),ue=a(17079),ae=a(16803),s=a(63313),E=a(26230),le=a(25641),U=s.forwardRef(function(l,j){var _,h=l.prefixCls,C=h===void 0?"rc-switch":h,e=l.className,f=l.checked,Z=l.defaultChecked,y=l.disabled,k=l.loadingIcon,V=l.checkedChildren,b=l.unCheckedChildren,o=l.onClick,O=l.onChange,x=l.onKeyDown,z=(0,ae.Z)(l,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),g=(0,E.Z)(!1,{value:f,defaultValue:Z}),i=(0,ue.Z)(g,2),B=i[0],J=i[1];function w(v,T){var R=B;return y||(R=v,J(R),O==null||O(R,T)),R}function G(v){v.which===le.Z.LEFT?w(!1,v):v.which===le.Z.RIGHT&&w(!0,v),x==null||x(v)}function se(v){var T=w(!B,v);o==null||o(T,v)}var Q=H()(C,e,(_={},(0,A.Z)(_,"".concat(C,"-checked"),B),(0,A.Z)(_,"".concat(C,"-disabled"),y),_));return s.createElement("button",Object.assign({},z,{type:"button",role:"switch","aria-checked":B,disabled:y,className:Q,ref:j,onKeyDown:G,onClick:se}),k,s.createElement("span",{className:"".concat(C,"-inner")},B?V:b))});U.displayName="Switch";var n=U,ne=a(82259),c=a(7893),te=a(65189),re=a(1570),D=function(l,j){var _={};for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&j.indexOf(h)<0&&(_[h]=l[h]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var C=0,h=Object.getOwnPropertySymbols(l);C<h.length;C++)j.indexOf(h[C])<0&&Object.prototype.propertyIsEnumerable.call(l,h[C])&&(_[h[C]]=l[h[C]]);return _},N=s.forwardRef(function(l,j){var _,h=l.prefixCls,C=l.size,e=l.disabled,f=l.loading,Z=l.className,y=Z===void 0?"":Z,k=D(l,["prefixCls","size","disabled","loading","className"]),V=s.useContext(ne.E_),b=V.getPrefixCls,o=V.direction,O=s.useContext(te.Z),x=s.useContext(c.Z),z=(e!=null?e:x)||f,g=b("switch",h),i=s.createElement("div",{className:"".concat(g,"-handle")},f&&s.createElement(ee.Z,{className:"".concat(g,"-loading-icon")})),B=H()((_={},(0,A.Z)(_,"".concat(g,"-small"),(C||O)==="small"),(0,A.Z)(_,"".concat(g,"-loading"),f),(0,A.Z)(_,"".concat(g,"-rtl"),o==="rtl"),_),y);return s.createElement(re.Z,{insertExtraNode:!0},s.createElement(n,(0,q.Z)({},k,{prefixCls:g,className:B,disabled:z,ref:j,loadingIcon:i})))});N.__ANT_SWITCH=!0;var oe=N},46207:function($){function S(a){return a==null}$.exports=S}}]);
